
```
#include <bits/stdc++.h>
using namespace std;

int main()
{
    int t, n, m;
    
    for (int k=0; k<t; k++)
    {
        //input
        cin >> n >> m;
        
        //건물 건설시간
        vector<int> demand;
        demand.resize(n+1, 0);
        
        //인접리스트
        vector<int> adj[1001];
        
        //건물의 테크단계
        vector<int> tech;
        tech.resize(n+1, 0);
        
        //진입차수
        vector<int> in_d;
        in_d.resize(n+1, 0);
        
        //같은 테크 건물들의 건설시간.
        vector<int> tech_time[1001];
        
        queue<int> q;
        
        for (int i=1; i<=n; i++) cin >> demand[i];
    
        for (int i=0; i<m; i++)
        {
            int a, b;
            cin >> a >> b;
        
            adj[a].push_back(b);
            in_d[b]++;
        }
        
        //solve
        for (int i=1; i<=n; i++)
        {
            if (in_d[i] == 0) 
            {
                q.push(i);
                tech[i] = 1;
            }
        }
    
        while( !q.empty() )
        {
            int cur = q.front();
            q.pop();
        
            for (int i=0; i< adj[cur].size(); i++)
            { 
                int nxt = adj[cur][i];
                if (--in_d[nxt] == 0) 
                {
                    q.push(nxt);
                    tech[nxt] = tech[cur] + 1;
                }
            }
        } 
        
        for (int i=1; i<=n; i++) tech_time[tech[i]].push_back( demand[i] );
        
        int res = 0;
        
        for (int i=1; i<=1000; i++)
        {
            int max = 0;
            for (int j=0; j<tech_time.size(); j++)
            {
                if (tech_time[i][j] > max) max = tech_time[i][j];
            }
            res += max;
            
        }
        
        cout << res << '\n';
    }
    
    return 0;
}
```
